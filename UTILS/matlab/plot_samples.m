function [] = plot_samples(samp,nr,nc,sol)
% function for plotting posterior samples of beachballs
% Input:
%     samp = samples - [ stk dip rak] or 6 Moment tensor
%     nr = number of rows
%     nc = number of columns
%     sol = correction solutions plotted in red


dia = 0.3;
yoffset = 0.35;
xoffset = 0.2;

%cc=hsv(2*length(samp));
%figure
for ii=1:nr
    for jj=1:nc
        if find(sol == ((ii-1)*nc+ jj))
            bb(samp((ii-1)*nc+ jj,:),jj,nr+1-ii,dia,0,'r')
        else
            %bb(samp((ii-1)*nc+ jj,:),jj,nr+1-ii,dia,0,cc((ii-1)*nc+ jj,:))
            bb(samp((ii-1)*nc+ jj,:),jj,nr+1-ii,dia,0,'b')
        end
        text(jj-xoffset, nr+1-ii+yoffset, sprintf('%d',(ii-1)*nc+ jj));
    end
end

axis equal
axis off

if 1==0
    % samples
    samp = [         0   89.9000  -82.5000
        63.6000   68.6000  -73.6000
        33.2000   60.8000    4.8000
        163.6000   76.5000   59.6000
        335.4000   55.4000   10.1000
        18.3000   39.9000  -86.6000
        90.8000   72.7000   67.7000
        191.4000   23.0000    2.8000
        291.8000   79.1000   69.5000
        205.4000   85.6000   56.7000
        354.6000   83.2000   70.9000
        282.4000   84.2000  -44.4000
        7.1000   67.8000   32.2000
        245.1000   41.2000  -88.9000
        224.8000   82.7000   21.2000
        277.5000   79.2000   -0.6000
        183.4000   71.6000   36.3000
        132.2000   28.8000  -23.2000
        189.1000   64.7000    7.7000
        240.5000   80.1000   59.5000
        310.3000   39.7000  -80.5000
        348.0000   70.5000  -75.2000
        97.3000   85.7000   31.7000
        291.7000   62.3000   12.5000
        184.4000   54.1000   43.0000
        313.8000   54.7000   83.6000
        120.1000   66.9000  -58.2000
        40.3000   31.5000   56.0000
        343.8000   25.3000  -65.0000
        247.0000   82.7000  -89.3000
        0.2000   78.9000   15.6000
        135.0000   88.5000   -6.3000
        282.7000   63.8000  -38.2000
        307.2000   58.3000   41.1000
        95.9000   38.4000   -5.8000
        70.9000   63.4000   41.1000
        347.8000   40.8000   -6.1000
        312.8000   82.3000   62.3000
        6.5000   19.8000   30.6000
        288.0000   81.8000   19.9000
        327.0000   39.2000  -24.1000
        339.9000   27.8000   -9.9000
        58.7000   64.9000   -3.6000
        11.2000   52.5000   52.6000
        65.7000   58.3000   71.8000
        111.2000   19.5000  -20.2000
        335.0000   24.3000  -29.2000
        191.8000   45.4000   84.8000
        276.5000   41.2000  -73.6000
        307.4000   79.9000  -86.4000
        150.9000   72.8000  -21.9000
        150.7000   82.0000  -21.4000
        107.9000   88.8000  -47.0000
        13.4000   77.2000    4.6000
        178.0000   28.1000   49.3000
        21.2000   83.1000    8.6000
        123.1000   62.8000   15.9000
        210.7000   86.0000   57.4000
        145.1000   54.2000  -55.6000
        321.2000   79.8000  -52.6000
        41.7000   80.9000   88.7000
        245.4000   35.7000   25.6000
        118.6000   42.5000   58.2000
        259.7000   48.9000  -25.4000
        219.7000   65.5000   56.7000
        278.6000   74.1000  -81.9000
        216.4000   59.1000   23.4000
        65.1000   73.8000   -8.6000
        231.5000   42.0000  -15.5000
        222.5000   51.8000   63.8000
        65.3000   72.1000  -85.8000
        3.3000   17.9000   88.3000
        73.8000   52.8000   78.4000
        201.4000   56.8000  -11.0000
        161.9000   72.1000  -53.9000
        77.7000   87.1000  -52.3000
        206.8000   23.8000  -15.2000
        235.5000   69.2000   15.6000
        141.1000   88.1000  -38.6000
        33.0000   63.6000   76.7000
        331.7000   52.7000   65.0000
        5.3000   46.6000   62.0000
        46.7000   86.6000  -87.6000
        140.8000   30.0000  -87.3000
        332.7000   27.5000   29.2000
        235.8000   85.6000  -73.3000
        1.2000   58.2000   52.2000
        235.4000   56.9000   53.7000
        261.6000   75.3000  -44.1000
        49.8000   61.1000   -5.8000
        36.3000   59.7000   64.5000
        3.6000   34.8000   83.6000
        7.0000   21.6000  -78.6000
        13.7000   79.0000  -40.2000
        161.0000   49.5000  -62.8000
        175.4000   49.5000    6.2000
        128.4000   66.8000   40.0000
        260.9000   72.2000  -70.8000
        327.9000   42.2000  -47.0000
        234.5000   68.4000  -85.3000
        305.7000   87.6000  -79.9000
        153.4000   61.3000    0.3000
        353.0000   52.6000   74.3000
        270.1000   44.5000   84.8000
        10.5000   74.7000  -86.7000
        29.0000   81.1000  -69.4000
        272.4000   20.2000  -66.8000
        213.3000   83.0000   17.9000
        23.7000   75.2000  -15.8000
        341.4000   69.3000  -86.9000
        350.4000   40.3000   65.2000
        145.8000   29.8000  -83.4000
        75.1000   65.0000   87.3000
        203.2000   54.8000   -5.7000
        167.1000   40.4000  -35.6000
        150.2000   84.3000  -65.4000
        251.3000   79.6000   70.8000
        263.1000   72.4000  -64.6000
        296.7000   63.8000   16.2000
        351.9000   59.8000   71.6000
        260.9000   74.9000   -8.1000
        94.3000   16.2000  -87.0000
        338.6000   25.6000  -72.4000
        187.6000   85.1000   53.2000
        312.8000   84.5000   68.4000
        2.2000   78.3000   -4.9000
        231.9000   20.9000  -72.3000
        205.5000   59.5000   28.7000
        321.4000   42.6000   34.1000
        291.4000   76.1000   47.4000
        276.7000   57.2000   -3.4000
        149.2000   85.8000    4.8000
        182.7000   41.3000  -66.4000
        3.4000   40.2000  -71.8000
        347.5000   84.9000  -69.1000
        322.7000   41.8000  -50.7000
        210.8000   76.1000   69.2000
        142.6000   86.8000   76.9000
        162.9000   29.5000  -48.6000
        176.0000   55.2000   63.5000
        78.6000   23.0000  -83.0000
        147.0000   86.9000  -71.1000
        190.7000   55.0000  -69.4000
        15.3000   59.9000   40.5000
        177.9000   69.8000  -83.7000
        131.9000   23.7000    0.9000
        310.2000   22.6000  -87.2000
        104.4000   76.2000   39.0000
        36.6000   39.0000  -46.0000
        155.4000   53.7000    2.6000
        276.7000   43.8000   54.6000
        266.6000   59.6000   57.3000
        21.3000   54.8000   65.1000
        198.4000   34.0000  -67.7000
        255.7000   89.9000  -84.3000
        104.9000   47.8000  -36.0000
        156.2000   74.1000  -67.6000
        48.4000   84.0000  -15.1000
        295.4000   74.9000  -63.3000
        5.0000   77.2000  -26.5000
        274.3000   65.1000   33.6000
        189.6000   70.7000  -64.1000
        135.1000   41.9000   41.4000
        263.5000   80.0000   10.2000
        246.8000   29.5000   10.5000
        124.1000   57.6000   83.2000
        332.3000   41.2000   33.7000
        121.0000   68.9000   37.4000
        238.5000   66.6000  -87.5000
        146.9000   48.1000  -50.5000
        32.0000   51.9000  -86.5000
        78.2000   78.1000  -22.6000
        143.9000   72.9000    4.4000
        285.2000   66.6000   40.9000
        251.0000   50.8000  -67.9000
        264.0000   80.3000  -84.9000
        77.9000   80.2000  -59.4000
        190.3000   71.8000   72.2000
        159.7000   85.5000  -65.3000
        192.7000   50.0000   61.6000
        349.1000   70.1000  -23.8000
        256.6000   87.4000  -67.5000
        93.0000   15.2000   60.7000
        247.6000   46.5000   55.6000
        188.9000   54.3000   33.1000
        165.7000   40.6000  -40.3000
        114.1000   86.2000  -63.3000
        170.1000   76.1000   80.1000
        119.0000   74.9000  -59.2000
        314.6000   30.3000   -3.9000
        78.0000   39.4000  -71.5000
        74.8000   76.6000  -60.1000
        95.4000   36.4000  -70.5000
        93.0000   28.4000  -51.3000
        239.4000   51.3000   52.7000
        124.5000   50.9000  -44.9000
        13.0000   36.2000  -17.1000
        157.8000   40.9000   51.2000
        172.9000   44.3000  -20.2000
        10.1000   65.3000   72.1000];
    
    % index of correct solution (if available)
    isol = [1 45];
    nr = 10;
    nc = 10;
    plot_samples(samp,nr,nc,isol)
end
